!function(n){"use strict";n(".hubaga-field").on("focus",function(){n(this).addClass("hubaga-is-focused")}).on("blur",function(){n(this).removeClass("hubaga-is-focused")}).on("keyup",function(){0===n(this).val().length?n(this).addClass("hubaga-is-empty"):n(this).removeClass("hubaga-is-empty")}),n(".navbar-collapse").on("click",function(t){t.preventDefault(),n("#mobile-primary-menu").toggleClass("toggled")}),n(document).on("mouseup",function(t){var a=n("#mobile-primary-menu");a.is(t.target)||0!==a.has(t.target).length||a.removeClass("toggled")});var t=function(t){return{id:n(t).data("product"),name:n(t).data("name"),price:n(t).data("price")}},a=[];n(".hubaga-buy").each(function(n){a.push(t(this))}),a.length&&gtag("event","view_item_list",{items:a}),n(".hubaga-buy").on("click",function(n){var a=t(this);gtag("event","select_content",{content_type:"product",items:[a]}),gtag("event","begin_checkout",{items:[a],coupon:""})}),n(".hubaga-show-coupon").on("click",function(t){t.preventDefault(),n(this).closest("form").find(".hubaga-coupon-grid").toggle()});var e=function(n){return{product:n.find('[name="hubaga_buy"]').val(),email:n.find('[name="email"]').val(),coupon:n.find(".hubaga-coupon-input").val()}},o=function(t,a){a.fadeTo(360,.5),t.action="hubaga_apply_coupon",t.nonce=i18.nonce;var e=a.find(".hubaga-coupon-grid");n.post(i18.ajaxurl,t,function(n){a.fadeTo(360,1),"success"==n.result?(e.hide(),a.find(".hubaga-order-total").html(n.price),e.find(".hubaga-coupon-notices").text(""),a.find(".hubaga-coupon-notice").hide(),gtag("event","checkout_progress",{items:{id:t.product,price:n.price.substr(1)},coupon:t.coupon})):"error"==n.result?e.find(".hubaga-coupon-notices").text(n.error):e.find(".hubaga-coupon-notices").text(i18.coupon_error)}).fail(function(){a.fadeTo(360,1),e.find(".hubaga-coupon-notices").text(i18.coupon_error)})};n(".hubaga-coupon-btn").on("click",function(t){t.preventDefault();var a=n(this).closest("form"),i=e(a);""!==i.coupon?o(i,a):a.find(".hubaga-coupon-notices").text(i18.empty_coupon)});var i=function(){return n(window).height()>500&&n(window).width()>350},u=n(".hubaga-instacheck-wrapper"),c=n(".hubaga-loader-wrapper");n(".hubaga-buy").on("click",function(t){if(i()&&"hubaga_buy"==n(this).data("action")){t.preventDefault();var a=n(this).data("product"),e=n(this).attr("href");s(a).fail(function(){window.location=e})}});var s=function(t,a){return t&&(a={nonce:i18.nonce,action:"hubaga_get_checkout",fetchedBy:"instacheck",product:t}),n(u).hide(),n(c).show(),n.post(i18.ajaxurl,a,function(t){if(n.isPlainObject(t))"redirect"==t.action&&(window.location=t.url);else{var a=n(u).find(".hubaga-instacheck-overlay");n(a).html(t),h(a,u),r(a)}n(c).hide(),n(u).show()})},h=function(t,a){return n('<span class="hubaga-close">&times;</span>').appendTo(t).on("click.pc_close",function(t){t.preventDefault(),n(a).hide()})},r=function(t){var a=n(t).find(".hubaga-checkout-form:not(.instacheck_disabled)");n(document).on("mouseup.hubaga-instacheck",function(a){t.is(a.target)||0!==t.has(a.target).length||n(u).hide()}),n(a).on("submit.hubaga-instacheck",function(t){t.preventDefault();var e=n(a).serialize()+"&nonce="+i18.nonce;s(null,e).fail(function(n){a.submit()})}),n(a).find(".hubaga-field").on("focus",function(){n(this).addClass("hubaga-is-focused")}).on("blur",function(){n(this).removeClass("hubaga-is-focused")}).on("keyup",function(){0===n(this).val().length?n(this).addClass("hubaga-is-empty"):n(this).removeClass("hubaga-is-empty")}),n(a).find('[name="gateway"]').on("change.hubaga-instacheck",function(t){gtag("event","set_checkout_option",{checkout_step:2,checkout_option:"gateway",value:n(a).find('[name="gateway"]').val()}),n(a).trigger("submit")}),n(a).find(".hubaga-show-coupon").on("click.hubaga-instacheck",function(t){t.preventDefault(),n(this).closest("form").find(".hubaga-coupon-grid").toggle()}),a.find(".hubaga-coupon-btn").on("click",function(n){n.preventDefault();var t=e(a);""!==t.coupon?o(t,a):a.find(".hubaga-coupon-notices").text(i18.empty_coupon)})}}(jQuery);